<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>äº‹æ¥­ä¸»ç ”ä¿®ç‰ˆ_åŠ´åƒç½å®³ç™ºç”Ÿæ™‚ã®å¯¾å¿œ</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
      background-color: #f7f7f7;
      color: #333;
    }
    .hidden {
      display: none;
    }
    .section {
      max-width: 800px;
      margin: auto;
      text-align: center;
    }
    .title {
      background-color: #0078d4;
      color: white;
      padding: 1em;
      border-radius: 8px;
      margin-bottom: 1em;
    }
    input[type="text"] {
      font-size: 1.2em;
      padding: 0.5em;
      width: 80%;
      max-width: 400px;
    }
    button {
      font-size: 1.2em;
      padding: 0.6em 1.2em;
      margin: 1em;
      cursor: pointer;
      border-radius: 8px;
      border: none;
      background-color: #0078d4;
      color: white;
    }
    button:hover {
      background-color: #106ebe;
    }
    .video-container {
      position: relative;
      width: 100%;
      max-width: 800px;
      margin: 0 auto;
      background-color: black;
      border-radius: 8px;
      overflow: hidden;
    }
    video {
      width: 100%;
      height: auto;
      display: block;
      outline: none;
    }
    /* ã‚·ãƒ¼ã‚¯ãƒãƒ¼ã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’éè¡¨ç¤ºã«ã™ã‚‹ - ä¸è¦ã«ãªã‚‹ãŒå¿µã®ãŸã‚æ®‹ã—ã¦ãŠã */
    video::-webkit-media-controls {
      display: none !important;
    }
    video::-moz-media-controls {
      display: none !important;
    }
    video::-webkit-media-controls-panel {
      display: none !important;
    }
    video::-webkit-media-controls-play-button {
      display: none !important;
    }
    video::-webkit-media-controls-timeline {
      display: none !important;
    }
    video::-webkit-media-controls-current-time-display {
      display: none !important;
    }
    video::-webkit-media-controls-time-remaining-display {
      display: none !important;
    }
    video::-webkit-media-controls-mute-button {
      display: none !important;
    }
    video::-webkit-media-controls-toggle-closed-captions-button {
      display: none !important;
    }
    video::-webkit-media-controls-volume-slider {
      display: none !important;
    }
    video::-webkit-media-controls-fullscreen-button {
      display: none !important;
    }
    #confirmationCode {
      font-weight: bold;
      font-size: 1.4em;
      margin-top: 1em;
      background-color: #e9e9e9;
      padding: 0.5em;
      border-radius: 6px;
      display: inline-block;
    }
    /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
    @media (max-width: 768px) {
      input[type="text"], button {
        width: 90%;
        max-width: none;
      }
      .section {
        max-width: 95%;
      }
      .video-container {
        max-width: 100%;
      }
    }
    @media (max-width: 480px) {
      body {
        margin: 10px;
      }
      .title h2 {
        font-size: 1.2em;
      }
      button {
        font-size: 1em;
        padding: 0.5em 1em;
      }
    }
  </style>
</head>
<body>

<div class="section">
  <div class="title">
    <h2>äº‹æ¥­ä¸»ç ”ä¿®ç‰ˆ_åŠ´åƒç½å®³ç™ºç”Ÿæ™‚ã®å¯¾å¿œ</h2>
  </div>
</div>

<div class="section" id="nameSection">
  <p>ã‚ãªãŸã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
  <input type="text" id="userName" placeholder="ä¾‹: å®‰å…¨ å¤ªéƒ" />
  <br />
  <button onclick="startVideo()">â–¶ å‹•ç”»ã‚’é–‹å§‹ã™ã‚‹</button>
</div>

<div class="section hidden" id="videoSection">
  <div class="video-container">
    <video
      id="trainingVideo"
      playsinline
      controls="false"  controlslist="nodownload nofullscreen noremoteplayback"
      disablePictureInPicture
      oncontextmenu="return false;"
    >
      <source src="training.mp4" type="video/mp4" />
      ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ video ã‚¿ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚
    </video>
  </div>
  <div id="customControls">
    <button onclick="togglePlayback()">â¯ï¸ ä¸€æ™‚åœæ­¢ / å†é–‹</button>
  </div>
</div>

<div class="section hidden" id="resultSection">
  <h3>å‹•ç”»ã‚’æœ€å¾Œã¾ã§è¦‹ã¦ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸï¼</h3>
  <p>ä»¥ä¸‹ã®ç¢ºèªã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€ãƒ•ã‚©ãƒ¼ãƒ ã«å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
  <div id="confirmationCode"></div>
  <p style="font-size: 0.9em; margin-top: 0.5em;">â€»ãŠæ‰‹æ•°ã§ã™ãŒæ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„</p>
  <br />
  <a href="https://forms.office.com/Pages/ResponsePage.aspx?id=JzxqYJ5BV0iDbmfkVvt5swEJNmwmImFKogaSKMNJmpZUOFBESThDMDVHRkY0OEw4VEhCUE9ZVEU2Ny4u" target="_blank">
    <button>ğŸ“„ ãƒ•ã‚©ãƒ¼ãƒ ã¸é€²ã‚€</button>
  </a>
</div>

<script>
  let lastKnownTime = 0; // å‹•ç”»ã®æœ€çµ‚å†ç”Ÿæ™‚åˆ»ã‚’ä¿æŒã™ã‚‹å¤‰æ•°

  function startVideo() {
    const name = document.getElementById("userName").value.trim();
    if (!name) {
      alert("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
      return;
    }

    // åå‰å…¥åŠ›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿éè¡¨ç¤º
    document.getElementById("nameSection").classList.add("hidden");
    document.getElementById("videoSection").classList.remove("hidden");

    const video = document.getElementById("trainingVideo");

    // ã‚·ãƒ¼ã‚¯ãƒãƒ¼æ“ä½œã‚’ç„¡åŠ¹åŒ–ï¼ˆæ—¢å­˜ã®ã‚‚ã®ã‚’ç¶­æŒï¼‰
    video.removeAttribute('controls'); // å¿µã®ãŸã‚videoé–‹å§‹æ™‚ã«controlså±æ€§ã‚’å‰Šé™¤
    
    // å³ã‚¯ãƒªãƒƒã‚¯ç„¡åŠ¹åŒ–ï¼ˆæ—¢å­˜ã®ã‚‚ã®ã‚’ç¶­æŒï¼‰
    video.addEventListener('contextmenu', function(e) {
      e.preventDefault();
      return false;
    });
    
    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆç„¡åŠ¹åŒ–ï¼ˆã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ãªã©ï¼‰ï¼ˆæ—¢å­˜ã®ã‚‚ã®ã‚’ç¶­æŒï¼‰
    video.addEventListener('keydown', function(e) {
      e.preventDefault();
      return false;
    });

    // å‹•ç”»ã®å†ç”Ÿæ™‚åˆ»ãŒæ›´æ–°ã•ã‚Œã‚‹ãŸã³ã«ãƒã‚§ãƒƒã‚¯
    video.addEventListener('timeupdate', function() {
      // ç¾åœ¨ã®å†ç”Ÿæ™‚åˆ»ãŒå‰å›è¨˜éŒ²ã—ãŸæ™‚åˆ»ã‚ˆã‚Šã‚‚å¤§ããé€²ã‚“ã§ã„ã‚‹å ´åˆï¼ˆæ—©é€ã‚Šã•ã‚ŒãŸã¨åˆ¤æ–­ï¼‰
      // ã‹ã¤ã€å‹•ç”»ãŒä¸€æ™‚åœæ­¢ä¸­ã§ãªã„å ´åˆ
      if (video.currentTime > lastKnownTime + 1 && !video.paused) { // 1ç§’ä»¥ä¸Šã®ã‚¹ã‚­ãƒƒãƒ—ã‚’æ¤œçŸ¥
        video.currentTime = lastKnownTime; // å†ç”Ÿä½ç½®ã‚’å…ƒã«æˆ»ã™
      } else {
        lastKnownTime = video.currentTime; // ç¾åœ¨ã®å†ç”Ÿæ™‚åˆ»ã‚’è¨˜éŒ²
      }
    });

    // ã‚·ãƒ¼ã‚¯æ“ä½œã‚’ç„¡åŠ¹åŒ–ï¼ˆæ—¢å­˜ã®ã‚‚ã®ã‚’ç¶­æŒã—ã¤ã¤ã€timeupdateã§å¼·åŠ›ã«åˆ¶å¾¡ï¼‰
    video.addEventListener('seeking', function(e) {
      e.preventDefault();
      video.currentTime = lastKnownTime; // ã‚·ãƒ¼ã‚¯è©¦è¡Œæ™‚ã«ç›´å‰ã®ä½ç½®ã«æˆ»ã™
    });
    
    video.play();

    video.addEventListener("ended", () => {
      document.getElementById("videoSection").classList.add("hidden");

      const code = generateCode(name);
      document.getElementById("confirmationCode").innerText = code;
      document.getElementById("resultSection").classList.remove("hidden");
    });
  }

  function togglePlayback() {
    const video = document.getElementById("trainingVideo");
    if (video.paused) {
      video.play();
    } else {
      video.pause();
    }
  }

  function generateCode(name) {
    const firstCharCode = name.charCodeAt(0);
    const lastCharCode = name.charCodeAt(name.length - 1);
    const nameLength = name.length;

    const day = new Date().getMonth() + 1;
    const dayPlus11 = String(day + 11).padStart(2, "0");
    const reversedDay = dayPlus11.split("").reverse().join("");

    return `${firstCharCode}-${lastCharCode}-${nameLength}-${reversedDay}`;
  }
</script>

</body>
</html>