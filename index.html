<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>äº‹æ¥­ä¸»ç ”ä¿®ç‰ˆ_åŠ´åƒç½å®³ç™ºç”Ÿæ™‚ã®å¯¾å¿œ</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
      background-color: #f7f7f7;
      color: #333;
    }
    .hidden {
      display: none;
    }
    .section {
      max-width: 800px;
      margin: auto;
      text-align: center;
    }
    .title {
      background-color: #0078d4;
      color: white;
      padding: 1em;
      border-radius: 8px;
      margin-bottom: 1em;
    }
    input[type="text"] {
      font-size: 1.2em;
      padding: 0.5em;
      width: 80%;
      max-width: 400px;
    }
    button {
      font-size: 1.2em;
      padding: 0.6em 1.2em;
      margin: 1em;
      cursor: pointer;
      border-radius: 8px;
      border: none;
      background-color: #0078d4;
      color: white;
    }
    button:hover {
      background-color: #106ebe;
    }
    .video-container {
      position: relative;
      width: 100%;
      max-width: 800px;
      margin: 0 auto;
      background-color: black;
      border-radius: 8px;
      overflow: hidden;
    }
    video {
      width: 100%;
      height: auto;
      display: block;
      outline: none;
    }
    /* ã‚·ãƒ¼ã‚¯ãƒãƒ¼ã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’éè¡¨ç¤ºã«ã™ã‚‹ - ä¸è¦ã«ãªã‚‹ãŒå¿µã®ãŸã‚æ®‹ã—ã¦ãŠã */
    video::-webkit-media-controls {
      display: none !important;
    }
    video::-moz-media-controls {
      display: none !important;
    }
    video::-webkit-media-controls-panel {
      display: none !important;
    }
    video::-webkit-media-controls-play-button {
      display: none !important;
    }
    video::-webkit-media-controls-timeline {
      display: none !important;
    }
    video::-webkit-media-controls-current-time-display {
      display: none !important;
    }
    video::-webkit-media-controls-time-remaining-display {
      display: none !important;
    }
    video::-webkit-media-controls-mute-button {
      display: none !important;
    }
    video::-webkit-media-controls-toggle-closed-captions-button {
      display: none !important;
    }
    video::-webkit-media-controls-volume-slider {
      display: none !important;
    }
    video::-webkit-media-controls-fullscreen-button {
      display: none !important;
    }
    #confirmationCode {
      font-weight: bold;
      font-size: 1.4em;
      margin-top: 1em;
      background-color: #e9e9e9;
      padding: 0.5em;
      border-radius: 6px;
      display: inline-block;
    }

    /* ã‚¯ã‚¤ã‚ºé–¢é€£ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    .quiz-question {
      font-size: 1.3em;
      margin-bottom: 1em;
      font-weight: bold;
    }
    .quiz-options button {
      display: block;
      width: 80%;
      margin: 0.8em auto;
      padding: 0.8em;
      background-color: #e0e0e0;
      color: #333;
      border: 1px solid #ccc;
      font-size: 1.1em;
    }
    .quiz-options button:hover {
      background-color: #d0d0d0;
    }
    .quiz-message {
      font-size: 1.1em;
      margin-top: 1em;
      font-weight: bold;
    }
    .quiz-message.correct {
      color: green;
    }
    .quiz-message.incorrect {
      color: red;
    }
    #nextQuestionButton {
      margin-top: 1em;
      background-color: #0078d4;
      color: white;
    }

    /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
    @media (max-width: 768px) {
      input[type="text"], button {
        width: 90%;
        max-width: none;
      }
      .section {
        max-width: 95%;
      }
      .video-container {
        max-width: 100%;
      }
    }
    @media (max-width: 480px) {
      body {
        margin: 10px;
      }
      .title h2 {
        font-size: 1.2em;
      }
      button {
        font-size: 1em;
        padding: 0.5em 1em;
      }
      .quiz-options button {
        font-size: 1em;
        padding: 0.6em;
      }
    }
  </style>
</head>
<body>

<div class="section">
  <div class="title">
    <h2>äº‹æ¥­ä¸»ç ”ä¿®ç‰ˆ_åŠ´åƒç½å®³ç™ºç”Ÿæ™‚ã®å¯¾å¿œ</h2>
  </div>
</div>

<div class="section" id="nameSection">
  <p>ã‚ãªãŸã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
  <input type="text" id="userName" placeholder="ä¾‹: å®‰å…¨å¤ªéƒ" />
  <br />
  <button onclick="startVideo()">â–¶ å‹•ç”»ã‚’é–‹å§‹ã™ã‚‹</button>
</div>

<div class="section hidden" id="videoSection">
  <div class="video-container">
    <video
      id="trainingVideo"
      playsinline
      controls="false"  controlslist="nodownload nofullscreen noremoteplayback"
      disablePictureInPicture
      oncontextmenu="return false;"
    >
      <source src="training.mp4" type="video/mp4" />
      ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ video ã‚¿ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚
    </video>
  </div>
  <div id="customControls">
    <button onclick="togglePlayback()">â¯ï¸ ä¸€æ™‚åœæ­¢ / å†é–‹</button>
  </div>
</div>

<div class="section hidden" id="quizIntroSection">
  <h3>å‹•ç”»è¦–è´å®Œäº†ï¼</h3>
  <p>æ¬¡ã¯å‹•ç”»ã®ç†è§£åº¦ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã„ã¾ã™ã€‚</p>
  <button onclick="startQuiz()">å‹•ç”»ã®ç†è§£åº¦ãƒã‚§ãƒƒã‚¯ã«é€²ã‚€</button>
</div>

<div class="section hidden" id="quizSection">
  <div id="quizContainer">
    <p>å…¨3å•ã®ã‚¯ã‚¤ã‚ºã«å…¨å•æ­£è§£ã™ã‚‹ã¨ã€å—è¬›å®Œäº†ç™»éŒ²ã«é€²ã‚ã¾ã™ã€‚</p> 
    <p class="quiz-question" id="quizQuestion"></p>
    <div class="quiz-options" id="quizOptions"></div>
    <div class="quiz-message" id="quizMessage"></div>
    <button id="nextQuestionButton" onclick="goToNextQuestion()" class="hidden">æ¬¡ã¸é€²ã‚€</button>
  </div>
</div>

<div class="section hidden" id="resultSection">
  <h3>ä»¥ä¸Šã§ã€ä»Šæœˆã®e-Learningã¯çµ‚äº†ã¨ãªã‚Šã¾ã™ã€‚</h3>
  <p>ä»¥ä¸‹ã®ç¢ºèªã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€ãƒ•ã‚©ãƒ¼ãƒ ã«å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
  <div id="confirmationCode"></div>
  <p style="font-size: 0.9em; margin-top: 0.5em; color: red; font-weight: bold;">
    â€»ç¢ºèªã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã‹ã‚‰ã€ã€Œå—è¬›å®Œäº†ç™»éŒ²ã«é€²ã‚€ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚
  </p>
  <br />
  <a href="https://forms.office.com/Pages/ResponsePage.aspx?id=JzxqYJ5BV0iDbmfkVvt5swEJNmwmImFKogaSKMNJmpZUOFBESThDMDVHRkY0OEw4VEhCUE9ZVEU2Ny4u"
     target="_blank" rel="noopener noreferrer">
    <button>ğŸ“„ å—è¬›å®Œäº†ç™»éŒ²ã«é€²ã‚€</button>
  </a>
</div>

<script>
  let lastKnownTime = 0; // å‹•ç”»ã®æœ€çµ‚å†ç”Ÿæ™‚åˆ»ã‚’ä¿æŒã™ã‚‹å¤‰æ•°
  let userName = ""; // ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ä¿æŒã™ã‚‹å¤‰æ•°

  // ã‚¯ã‚¤ã‚ºã®å•é¡Œãƒ‡ãƒ¼ã‚¿ï¼ˆ10å•ï¼‰
  const quizQuestions = [
    {
      question: "åŠ´åƒç½å®³ãŒç™ºç”Ÿã—ãŸéš›ã€è² å‚·è€…ã®æ•‘è­·ã§æœ€ã‚‚å„ªå…ˆã™ã¹ãã“ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ",
      options: ["ã™ãã«æ•‘æ€¥è»Šã‚’å‘¼ã¶", "å¿œæ€¥æ‰‹å½“ã‚’è¡Œã†", "ä½œæ¥­ã‚’ä¸­æ–­ã—ã¦åŸå› ã‚’èª¿ã¹ã‚‹", "ä¸Šå¸ã«å ±å‘Šã™ã‚‹"],
      answer: "å¿œæ€¥æ‰‹å½“ã‚’è¡Œã†"
    },
    {
      question: "åŠ´åƒç½å®³ç™ºç”Ÿå¾Œã®å ±å‘Šç¾©å‹™ã«ã¤ã„ã¦ã€æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
      options: ["åŠ´åƒåŸºæº–ç›£ç£ç½²ã¸ã®å ±å‘Šã¯ä»»æ„ã§ã‚ã‚‹", "æ­»å‚·ç—…å ±å‘Šæ›¸ã¯ã€åŠ´åƒç½å®³ç™ºç”Ÿå¾Œé€Ÿã‚„ã‹ã«æå‡ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹", "è»½å¾®ãªç½å®³ã¯å ±å‘Šä¸è¦ã§ã‚ã‚‹", "å ±å‘Šã¯ä¼šç¤¾ã®äººäº‹éƒ¨ãŒè¡Œã†ã‚‚ã®ã§ã‚ã‚Šã€äº‹æ¥­ä¸»ã¯é–¢ä¸ã—ãªã„"],
      answer: "æ­»å‚·ç—…å ±å‘Šæ›¸ã¯ã€åŠ´åƒç½å®³ç™ºç”Ÿå¾Œé€Ÿã‚„ã‹ã«æå‡ºã™ã‚‹å¿…è¦ãŒã‚ã‚‹"
    },
    {
      question: "åŠ´åƒç½å®³ç™ºç”Ÿæ™‚ã€ç¾å ´ä¿å­˜ã®ç›®çš„ã¨ã—ã¦é©åˆ‡ãªã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
      options: ["ç½å®³ç™ºç”Ÿã‚’éš è”½ã™ã‚‹ãŸã‚", "åŸå› ç©¶æ˜ã¨å†ç™ºé˜²æ­¢ã®ãŸã‚", "å ±é“æ©Ÿé–¢ã¸ã®æƒ…å ±æä¾›ã®ãŸã‚", "è² å‚·è€…ã®è²¬ä»»ã‚’æ˜ç¢ºã«ã™ã‚‹ãŸã‚"],
      answer: "åŸå› ç©¶æ˜ã¨å†ç™ºé˜²æ­¢ã®ãŸã‚"
    },
    {
      question: "åŠ´åƒç½å®³ãŒç™ºç”Ÿã—ãŸéš›ã€äº‹æ¥­ä¸»ãŒã¾ãšè¡Œã†ã¹ãåˆå‹•å¯¾å¿œã¨ã—ã¦æœ€ã‚‚é‡è¦ãªã‚‚ã®ã¯ä½•ã§ã™ã‹ï¼Ÿ",
      options: ["è² å‚·è€…ã®æ°åã‚’ç¢ºèªã™ã‚‹", "è² å‚·è€…ã‚’å®‰å…¨ãªå ´æ‰€ã¸ç§»å‹•ã•ã›ã‚‹", "ä½œæ¥­å“¡å…¨å“¡ã‚’é›†ã‚ã¦èª¬æ˜ä¼šã‚’é–‹ã", "ç½å®³ç¾å ´ã®å†™çœŸã‚’æ’®ã‚‹"],
      answer: "è² å‚·è€…ã‚’å®‰å…¨ãªå ´æ‰€ã¸ç§»å‹•ã•ã›ã‚‹"
    },
    {
      question: "åŠ´åƒç½å®³èª¿æŸ»ã®ç›®çš„ã¨ã—ã¦ã€æœ€ã‚‚é©åˆ‡ãªã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
      options: ["è²¬ä»»ã®æ‰€åœ¨ã‚’æ˜ç¢ºã«ã™ã‚‹ãŸã‚", "ä¿é™ºé‡‘ã®è«‹æ±‚ã®ãŸã‚", "é¡ä¼¼ç½å®³ã®å†ç™ºé˜²æ­¢ã®ãŸã‚", "ä¼æ¥­ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å®ˆã‚‹ãŸã‚"],
      answer: "é¡ä¼¼ç½å®³ã®å†ç™ºé˜²æ­¢ã®ãŸã‚"
    },
    {
      question: "åŠ´åƒå®‰å…¨è¡›ç”Ÿæ³•ã«ãŠã„ã¦ã€äº‹æ¥­ä¸»ãŒè¬›ãšã¹ãæªç½®ã¨ã—ã¦å®šã‚ã‚‰ã‚Œã¦ã„ã‚‹ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
      options: ["åŠ´åƒè€…ã«å¿«é©ãªä¼‘æ†©å ´æ‰€ã‚’æä¾›ã™ã‚‹ç¾©å‹™ã¯ãªã„", "å±é™ºã¾ãŸã¯æœ‰å®³ãªæ¥­å‹™ã«é–¢ã™ã‚‹å®‰å…¨è¡›ç”Ÿæ•™è‚²ã®å®Ÿæ–½", "ç§çš„ãªç—…æ°—ã®æ²»ç™‚è²»ã‚’å…¨é¡è² æ‹…ã™ã‚‹", "åŠ´åƒè€…ã®å¥åº·è¨ºæ–­ã¯å¹´ã«ä¸€åº¦ã ã‘ã§è‰¯ã„"],
      answer: "å±é™ºã¾ãŸã¯æœ‰å®³ãªæ¥­å‹™ã«é–¢ã™ã‚‹å®‰å…¨è¡›ç”Ÿæ•™è‚²ã®å®Ÿæ–½"
    },
    {
      question: "åŠ´åƒç½å®³ãŒç™ºç”Ÿã—ã€ä½œæ¥­ãŒä¸­æ–­ã•ã‚ŒãŸå ´åˆã€ä½œæ¥­å†é–‹ã®åˆ¤æ–­åŸºæº–ã¨ã—ã¦é©åˆ‡ãªã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
      options: ["ä½œæ¥­å“¡ã®å£«æ°—ãŒä¸ŠãŒã£ãŸæ™‚", "åŸå› ãŒç‰¹å®šã•ã‚Œã€å®‰å…¨å¯¾ç­–ãŒè¬›ã˜ã‚‰ã‚ŒãŸå¾Œ", "è² å‚·è€…ãŒå›å¾©ã—ãŸå¾Œ", "è­¦å¯Ÿã®è¨±å¯ãŒä¸‹ã‚ŠãŸæ™‚"],
      answer: "åŸå› ãŒç‰¹å®šã•ã‚Œã€å®‰å…¨å¯¾ç­–ãŒè¬›ã˜ã‚‰ã‚ŒãŸå¾Œ"
    },
    {
      question: "åŠ´åƒç½å®³é˜²æ­¢ã®ãŸã‚ã®ãƒ’ãƒ¤ãƒªãƒ»ãƒãƒƒãƒˆæ´»å‹•ã®ç›®çš„ã¯ä½•ã§ã™ã‹ï¼Ÿ",
      options: ["ç½å®³ã®ç™ºç”Ÿã‚’è¨˜éŒ²ã™ã‚‹ã“ã¨", "åŠ´åƒè€…ã®æ³¨æ„åŠ›ã‚’è©¦ã™ã“ã¨", "äº‹æ•…ã«ã¤ãªãŒã‚Šã‹ã­ãªã„äº‹è±¡ã‹ã‚‰å¯¾ç­–ã‚’è€ƒãˆã‚‹ã“ã¨", "è²¬ä»»ã®æ‰€åœ¨ã‚’æ˜ç¢ºã«ã™ã‚‹ã“ã¨"],
      answer: "äº‹æ•…ã«ã¤ãªãŒã‚Šã‹ã­ãªã„äº‹è±¡ã‹ã‚‰å¯¾ç­–ã‚’è€ƒãˆã‚‹ã“ã¨"
    },
    {
      question: "å¥åº·è¨ºæ–­ã®çµæœã€ç•°å¸¸ãŒã‚ã£ãŸåŠ´åƒè€…ã«å¯¾ã—ã¦ã€äº‹æ¥­ä¸»ãŒè¬›ãšã¹ãæªç½®ã¨ã—ã¦æ­£ã—ã„ã‚‚ã®ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ",
      options: ["ç›´ã¡ã«è§£é›‡ã™ã‚‹", "ç‰¹ã«æªç½®ã¯å¿…è¦ãªã„", "åŒ»å¸«ã®æ„è¦‹ã‚’èãã€é©åˆ‡ãªå°±æ¥­ä¸Šã®æªç½®ã‚’è¬›ã˜ã‚‹", "ä»–ã®éƒ¨ç½²ã¸ç•°å‹•ã•ã›ã‚‹"],
      answer: "åŒ»å¸«ã®æ„è¦‹ã‚’èãã€é©åˆ‡ãªå°±æ¥­ä¸Šã®æªç½®ã‚’è¬›ã˜ã‚‹"
    },
    {
      question: "ã‚¹ãƒˆãƒ¬ã‚¹ãƒã‚§ãƒƒã‚¯åˆ¶åº¦ã®ç›®çš„ã¯ä½•ã§ã™ã‹ï¼Ÿ",
      options: ["åŠ´åƒè€…ã®ã‚¹ãƒˆãƒ¬ã‚¹ãƒ¬ãƒ™ãƒ«ã‚’ç«¶ã‚ã›ã‚‹ãŸã‚", "åŠ´åƒè€…ã®ç²¾ç¥çš„ãªå¥åº·çŠ¶æ…‹ã‚’æŠŠæ¡ã—ã€ãƒ¡ãƒ³ã‚¿ãƒ«ãƒ˜ãƒ«ã‚¹ä¸èª¿ã‚’æœªç„¶ã«é˜²æ­¢ã™ã‚‹ãŸã‚", "åŠ´åƒè€…ã®æ¥­å‹™é‡ã‚’å¢—ã‚„ã™ãŸã‚", "ä¼šç¤¾ã®é›°å›²æ°—ã‚’è‰¯ãã™ã‚‹ãŸã‚"],
      answer: "åŠ´åƒè€…ã®ç²¾ç¥çš„ãªå¥åº·çŠ¶æ…‹ã‚’æŠŠæ¡ã—ã€ãƒ¡ãƒ³ã‚¿ãƒ«ãƒ˜ãƒ«ã‚¹ä¸èª¿ã‚’æœªç„¶ã«é˜²æ­¢ã™ã‚‹ãŸã‚"
    }
  ];

  let selectedQuizQuestions = []; // å®Ÿéš›ã«è¡¨ç¤ºã™ã‚‹3å•ã‚’æ ¼ç´
  let currentQuestionIndex = 0; // ç¾åœ¨è¡¨ç¤ºä¸­ã®ã‚¯ã‚¤ã‚ºã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
  let correctAnswersCount = 0; // æ­£è§£æ•°

  function startVideo() {
    const nameInput = document.getElementById("userName");
    userName = nameInput.value.trim(); // ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã«ä¿å­˜

    // 1. åå‰ãŒç©ºæ¬„ã®å ´åˆ
    if (!userName) {
      alert("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
      return;
    }

    // 2. åå‰ã®æ–‡å­—æ•°ãƒã‚§ãƒƒã‚¯ï¼ˆ3æ–‡å­—ä»¥ä¸Šã‚’è¨±å¯ï¼‰
    if (userName.length < 3) {
      alert("åå‰ã¯3æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚");
      return;
    }

    // 3. åŠè§’æ–‡å­—ã®ãƒã‚§ãƒƒã‚¯ï¼ˆå…¨è§’ã²ã‚‰ãŒãªã€ã‚«ã‚¿ã‚«ãƒŠã€æ¼¢å­—ã®ã¿ã‚’è¨±å¯ï¼‰
    const zenkakuRegex = /^[ã-ã‚“ã‚¡-ãƒ¶ä¸€-é¾ ]+$/;
    if (!zenkakuRegex.test(userName)) {
      alert("åå‰ã¯å…¨è§’ã®ã²ã‚‰ãŒãªã€ã‚«ã‚¿ã‚«ãƒŠã€ã¾ãŸã¯æ¼¢å­—ã§å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆåŠè§’æ–‡å­—ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ï¼‰ã€‚");
      return;
    }

    // åå‰å…¥åŠ›ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã¿éè¡¨ç¤º
    document.getElementById("nameSection").classList.add("hidden");
    document.getElementById("videoSection").classList.remove("hidden");

    const video = document.getElementById("trainingVideo");

    // ã‚·ãƒ¼ã‚¯ãƒãƒ¼æ“ä½œã‚’ç„¡åŠ¹åŒ–ï¼ˆæ—¢å­˜ã®ã‚‚ã®ã‚’ç¶­æŒï¼‰
    video.removeAttribute('controls'); 
    
    // å³ã‚¯ãƒªãƒƒã‚¯ç„¡åŠ¹åŒ–ï¼ˆæ—¢å­˜ã®ã‚‚ã®ã‚’ç¶­æŒï¼‰
    video.addEventListener('contextmenu', function(e) {
      e.preventDefault();
      return false;
    });
    
    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆç„¡åŠ¹åŒ–ï¼ˆã‚¹ãƒšãƒ¼ã‚¹ã‚­ãƒ¼ãªã©ï¼‰ï¼ˆæ—¢å­˜ã®ã‚‚ã®ã‚’ç¶­æŒï¼‰
    video.addEventListener('keydown', function(e) {
      e.preventDefault();
      return false;
    });

    // å‹•ç”»ã®å†ç”Ÿæ™‚åˆ»ãŒæ›´æ–°ã•ã‚Œã‚‹ãŸã³ã«ãƒã‚§ãƒƒã‚¯
    video.addEventListener('timeupdate', function() {
      // ç¾åœ¨ã®å†ç”Ÿæ™‚åˆ»ãŒå‰å›è¨˜éŒ²ã—ãŸæ™‚åˆ»ã‚ˆã‚Šã‚‚å¤§ããé€²ã‚“ã§ã„ã‚‹å ´åˆï¼ˆæ—©é€ã‚Šã•ã‚ŒãŸã¨åˆ¤æ–­ï¼‰
      // ã‹ã¤ã€å‹•ç”»ãŒä¸€æ™‚åœæ­¢ä¸­ã§ãªã„å ´åˆ
      if (video.currentTime > lastKnownTime + 1 && !video.paused) { // 1ç§’ä»¥ä¸Šã®ã‚¹ã‚­ãƒƒãƒ—ã‚’æ¤œçŸ¥
        video.currentTime = lastKnownTime; // å†ç”Ÿä½ç½®ã‚’å…ƒã«æˆ»ã™
      } else {
        lastKnownTime = video.currentTime; // ç¾åœ¨ã®å†ç”Ÿæ™‚åˆ»ã‚’è¨˜éŒ²
      }
    });

    // ã‚·ãƒ¼ã‚¯æ“ä½œã‚’ç„¡åŠ¹åŒ–ï¼ˆæ—¢å­˜ã®ã‚‚ã®ã‚’ç¶­æŒã—ã¤ã¤ã€timeupdateã§å¼·åŠ›ã«åˆ¶å¾¡ï¼‰
    video.addEventListener('seeking', function(e) {
      e.preventDefault();
      video.currentTime = lastKnownTime; // ã‚·ãƒ¼ã‚¯è©¦è¡Œæ™‚ã«ç›´å‰ã®ä½ç½®ã«æˆ»ã™
    });
    
    video.play();

    video.addEventListener("ended", () => {
      document.getElementById("videoSection").classList.add("hidden");
      document.getElementById("quizIntroSection").classList.remove("hidden"); // ã‚¯ã‚¤ã‚ºç´¹ä»‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤º
    });
  }

  function togglePlayback() {
    const video = document.getElementById("trainingVideo");
    if (video.paused) {
      video.play();
    } else {
      video.pause();
    }
  }

  // é…åˆ—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«ã™ã‚‹é–¢æ•° (Fisher-Yatesã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ )
  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  function startQuiz() {
    document.getElementById("quizIntroSection").classList.add("hidden");
    document.getElementById("quizSection").classList.remove("hidden");
    
    // ã‚¯ã‚¤ã‚ºã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
    currentQuestionIndex = 0;
    correctAnswersCount = 0;
    document.getElementById("quizMessage").innerText = ""; // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¯ãƒªã‚¢
    document.getElementById("nextQuestionButton").classList.add("hidden"); // ã€Œæ¬¡ã¸é€²ã‚€ã€ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤ºã«

    // 10å•ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«3å•é¸æŠ
    selectedQuizQuestions = shuffleArray([...quizQuestions]).slice(0, 3);
    
    displayQuestion();
  }

  function displayQuestion() {
    const questionContainer = document.getElementById("quizQuestion");
    const optionsContainer = document.getElementById("quizOptions");
    const messageContainer = document.getElementById("quizMessage");
    const nextButton = document.getElementById("nextQuestionButton");

    messageContainer.innerText = ""; // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢
    nextButton.classList.add("hidden"); // ã€Œæ¬¡ã¸é€²ã‚€ã€ãƒœã‚¿ãƒ³ã‚’éè¡¨ç¤ºã«

    if (currentQuestionIndex < selectedQuizQuestions.length) {
      const questionData = selectedQuizQuestions[currentQuestionIndex];
      questionContainer.innerText = `Q${currentQuestionIndex + 1}. ${questionData.question}`;
      optionsContainer.innerHTML = ""; // é¸æŠè‚¢ã‚’ã‚¯ãƒªã‚¢

      // é¸æŠè‚¢ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
      const shuffledOptions = shuffleArray([...questionData.options]);

      shuffledOptions.forEach((option, index) => {
        const button = document.createElement("button");
        button.innerText = option;
        button.onclick = () => checkAnswer(option);
        optionsContainer.appendChild(button);
      });
    } else {
      // å…¨å•è§£ç­”æ¸ˆã¿ã®å ´åˆã€çµæœã‚’è¡¨ç¤º
      showResult();
    }
  }

  function checkAnswer(selectedOption) {
    const questionData = selectedQuizQuestions[currentQuestionIndex];
    const messageContainer = document.getElementById("quizMessage");
    const optionsContainer = document.getElementById("quizOptions");
    const nextButton = document.getElementById("nextQuestionButton");

    // å…¨ã¦ã®é¸æŠè‚¢ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
    Array.from(optionsContainer.children).forEach(button => {
      button.disabled = true;
    });

    if (selectedOption === questionData.answer) {
      correctAnswersCount++;
      messageContainer.innerText = "æ­£è§£ã§ã™ï¼";
      messageContainer.classList.remove("incorrect");
      messageContainer.classList.add("correct");
    } else {
      messageContainer.innerText = `ä¸æ­£è§£ã§ã™ã€‚æ­£è§£ã¯ã€Œ${questionData.answer}ã€ã§ã—ãŸã€‚`;
      messageContainer.classList.remove("correct");
      messageContainer.classList.add("incorrect");
    }

    nextButton.classList.remove("hidden"); // ã€Œæ¬¡ã¸é€²ã‚€ã€ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º
  }

  function goToNextQuestion() {
    currentQuestionIndex++; // æ¬¡ã®è³ªå•ã¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’é€²ã‚ã‚‹
    displayQuestion(); // æ¬¡ã®è³ªå•ã‚’è¡¨ç¤º
  }

  function showResult() {
    const quizSection = document.getElementById("quizSection");
    const resultSection = document.getElementById("resultSection");
    const quizContainer = document.getElementById("quizContainer");

    quizSection.classList.add("hidden"); // ã‚¯ã‚¤ã‚ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’éè¡¨ç¤ºã«

    if (correctAnswersCount === selectedQuizQuestions.length) {
      // å…¨å•æ­£è§£ã®å ´åˆ
      resultSection.classList.remove("hidden");
      const code = generateCode(userName); // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°userNameã‚’ä½¿ç”¨
      document.getElementById("confirmationCode").innerText = code;
    } else {
      // ä¸æ­£è§£ãŒã‚ã‚‹å ´åˆ
      resultSection.classList.add("hidden"); // çµæœã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯è¡¨ç¤ºã—ãªã„
      quizContainer.innerHTML = `
        <p>æ®‹å¿µï¼å…¨å•æ­£è§£ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚å†åº¦ã‚¯ã‚¤ã‚ºã«æŒ‘æˆ¦ã—ã¦ãã ã•ã„ã€‚</p>
        <button onclick="restartQuiz()">å†åº¦ã‚¯ã‚¤ã‚ºã«æŒ‘æˆ¦ã™ã‚‹</button>
      `;
      quizSection.classList.remove("hidden"); // ã‚¯ã‚¤ã‚ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å†åº¦è¡¨ç¤º
    }
  }

  function restartQuiz() {
    document.getElementById("quizContainer").innerHTML = `
      <p class="quiz-question" id="quizQuestion"></p>
      <div class="quiz-options" id="quizOptions"></div>
      <div class="quiz-message" id="quizMessage"></div>
      <button id="nextQuestionButton" onclick="goToNextQuestion()" class="hidden">æ¬¡ã¸é€²ã‚€</button>
    `; // ã‚¯ã‚¤ã‚ºã®DOMã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã™
    startQuiz(); // ã‚¯ã‚¤ã‚ºã‚’æœ€åˆã‹ã‚‰é–‹å§‹
  }

  function generateCode(name) {
    const firstCharCode = name.charCodeAt(0);
    const lastCharCode = name.charCodeAt(name.length - 1);
    const nameLength = name.length;

    const day = new Date().getMonth() + 1;
    const dayPlus11 = String(day + 11).padStart(2, "0");
    const reversedDay = dayPlus11.split("").reverse().join("");

    return `${firstCharCode}-${lastCharCode}-${nameLength}-${reversedDay}`;
  }
</script>

</body>
</html>